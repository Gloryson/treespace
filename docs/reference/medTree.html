<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Geometric median tree function — medTree • treespace</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">treespace</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Geometric median tree function</h1>
    </div>

    
    <p>Finds the geometric median of a set of trees according to the Kendall Colijn metric.</p>
    

    <pre><span class='fu'>medTree</span>(<span class='no'>x</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>emphasise.tips</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>emphasise.weight</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>return.lambda.function</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>save.memory</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>x</dt>
      <dd>A list of trees of the class multiPhylo, for which the median tree will be computed, 
OR a matrix of tree vectors as given by <code>treespace$vectors</code>.</dd>
      <dt>groups</dt>
      <dd>an optional factor defining groups of trees; if provided, one median tree will be found for each group.</dd>
      <dt>lambda</dt>
      <dd>a number in [0,1] which specifies the extent to which topology (default, with lambda=0)  or branch lengths (lambda=1) are emphasised. This argument is ignored if <code>return.lambda.function=TRUE</code> or if the vectors are already supplied as the object <code>x</code>.</dd>
      <dt>weights</dt>
      <dd>A vector of weights for the trees. Defaults to a vector of 1&#39;s so that all trees are equally weighted, but can be used to encode likelihood, posterior probabilities or other characteristics.</dd>
      <dt>emphasise.tips</dt>
      <dd>an optional list of tips whose entries in the tree vectors should be emphasised. Defaults to <code>NULL</code>.</dd>
      <dt>emphasise.weight</dt>
      <dd>applicable only if a list is supplied to <code>emphasise.tips</code>, this value (default 2) is the number by which vector entries corresponding to those tips are emphasised.</dd>
      <dt>return.lambda.function</dt>
      <dd>If true, a function that can be invoked with different lambda values is returned.
This function returns the vector of metric values for the given lambda. Ignored if the tree vectors are already supplied as the object <code>x</code>.</dd>
      <dt>save.memory</dt>
      <dd>A flag that saves a lot of memory but increases the execution time (not compatible with return.lambda.function=TRUE). Ignored if the tree vectors are already supplied as the object <code>x</code>.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of five objects: 
<ul>
<li> $centre is the &quot;central vector&quot;, that is, the (weighted) mean of the tree vectors (which typically does not correspond to a tree itself); 
</li>
<li> $distances gives the distance of each tree from the central vector; 
</li>
<li> $mindist is the minimum of these distances; 
</li>
<li> $treenumbers gives the numbers (and, if supplied, names) of the &quot;median tree(s)&quot;, that is, the tree(s) which achieve this minimum distance to the centre; 
</li>
<li> $trees if trees were supplied then this returns the median trees as a multiPhylo object. 
</li>
</ul></p>
    <p>If groups are provided, then one list is returned for each group.
If <code>return.lambda.function=TRUE</code> then a function is returned that produces this list for a given value of lambda.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## EXAMPLE WITH WOODMICE DATA</span>
<span class='fu'>data</span>(<span class='no'>woodmiceTrees</span>)

<span class='co'>## LOOKING FOR A SINGLE MEDIAN</span>
<span class='co'>## get median tree(s)</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>medTree</span>(<span class='no'>woodmiceTrees</span>)
<span class='no'>res</span></div><div class='output co'>#&gt; $centre
#&gt;       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]   [,8]  [,9] [,10] [,11] [,12]
#&gt; [1,] 4.035 2.129 5.522 2.214 3.821 2.129 2.204 0.2338 5.338 4.423 2.129 3.343
#&gt;      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20]  [,21] [,22] [,23] [,24]
#&gt; [1,]     0 3.448 2.199 3.886 2.303 3.343 2.199 2.289 0.1841 3.856 4.751 2.199
#&gt;      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32]  [,33] [,34] [,35] [,36]
#&gt; [1,] 3.114     0 3.358 2.124 2.826  1.98  4.08 2.766 0.1443 2.124 2.174 4.622
#&gt;      [,37] [,38] [,39] [,40] [,41] [,42] [,43]  [,44] [,45] [,46] [,47] [,48]
#&gt; [1,] 1.861     0 1.965 2.209  4.02 2.124 2.199 0.2338 6.373 4.239 2.124 3.408
#&gt;      [,49] [,50] [,51] [,52] [,53]   [,54] [,55] [,56] [,57] [,58] [,59] [,60]
#&gt; [1,]     0 3.493  2.06 2.826  3.93 0.04975 2.209 2.269 2.826 1.945     0 2.045
#&gt;      [,61] [,62]  [,63] [,64] [,65] [,66] [,67] [,68] [,69] [,70]  [,71] [,72]
#&gt; [1,]  1.98  2.05 0.3433  3.97 3.318  1.98 4.731     0 4.323 2.766 0.1443 2.124
#&gt;      [,73] [,74] [,75] [,76] [,77]  [,78] [,79] [,80] [,81] [,82] [,83] [,84]
#&gt; [1,] 2.174 4.448 1.861     0 1.965 0.0398 2.199 2.259 2.766 1.935     0 2.035
#&gt;       [,85]  [,86]  [,87]  [,88] [,89]  [,90] [,91] [,92] [,93] [,94] [,95]
#&gt; [1,] 0.2338 0.1841 0.1443 0.3682     0 0.3333 4.184 2.124 3.378     0 3.463
#&gt;      [,96] [,97] [,98] [,99] [,100] [,101] [,102] [,103] [,104] [,105] [,106]
#&gt; [1,] 2.174  3.09     0 3.269  1.861      0  1.965      0  4.413      0      1
#&gt;      [,107] [,108] [,109] [,110] [,111] [,112] [,113] [,114] [,115] [,116]
#&gt; [1,]      1      1      1      1      1      1      1      1      1      1
#&gt;      [,117] [,118] [,119] [,120]
#&gt; [1,]      1      1      1      1
#&gt; 
#&gt; $distances
#&gt;   [1]  2.774  3.267  6.944 14.674  7.134  7.837 18.676  3.223  2.774  3.223
#&gt;  [11]  3.168 13.049 16.296  3.347  7.905  8.031  6.355  8.130 15.601  3.912
#&gt;  [21]  7.923 15.927  7.341  4.444  4.127  8.430 13.493  4.127 16.533 14.686
#&gt;  [31]  8.787  5.990  7.349 17.343 15.619  5.495 16.802  5.765  5.220  7.459
#&gt;  [41]  3.065  7.392  6.969 10.828  4.868  7.643 15.797  7.368 11.822  4.057
#&gt;  [51] 13.132  6.944 16.828  3.168 17.153  6.965  5.313  2.774  7.954 15.043
#&gt;  [61] 16.435  3.968 15.693  6.615  5.193 11.587 17.860  9.123  7.392  4.224
#&gt;  [71]  6.654 11.494  2.774 16.305  4.302 10.385  5.971  4.329  7.348 13.786
#&gt;  [81]  5.811  4.939  9.103  5.918 17.524  2.774  8.430 16.348  4.903  5.463
#&gt;  [91]  3.347  6.724  4.127 16.533  3.772 17.925  4.278  6.043  6.607  5.228
#&gt; [101] 16.983 13.589 17.608  7.964 13.088  7.855  9.698  5.626  5.143  8.505
#&gt; [111]  5.990 13.197  8.269  7.298 13.414  7.372  6.399  2.774  3.065  7.666
#&gt; [121]  4.469  4.441  3.122  8.361  4.302  6.019  3.168  5.362  7.417 17.581
#&gt; [131]  8.474 13.285 12.332  2.946  3.977  7.490  2.774  4.760  2.836  6.755
#&gt; [141]  3.168 15.035  4.903  9.581  4.456  3.518  7.927  3.772  8.462 10.902
#&gt; [151]  4.903  9.417  8.331  5.143  7.905  4.186  4.262  7.985  2.836  3.465
#&gt; [161]  3.415  7.464  6.553  3.125 16.093  7.515  4.421  7.902  4.057 17.367
#&gt; [171]  6.553  4.021 13.088  3.956  7.653 10.056  5.990 11.800  8.430 11.587
#&gt; [181]  5.990  2.946 16.103  4.684 18.967  5.626 16.678  4.873  8.574  3.267
#&gt; [191]  3.335  4.047  6.019  3.168  6.062  8.340 15.081 16.983 19.076  7.348
#&gt; [201] 10.691
#&gt; 
#&gt; $mindist
#&gt; [1] 2.774
#&gt; 
#&gt; $treenumbers
#&gt; [1]   1   9  58  73  86 118 137
#&gt; 
#&gt; $trees
#&gt; 7 phylogenetic trees
#&gt; </div><div class='input'>
<span class='co'>## plot first tree</span>
<span class='no'>med.tree</span> <span class='kw'>&lt;-</span> <span class='no'>res</span>$<span class='no'>trees</span><span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='fu'>plot</span>(<span class='no'>med.tree</span>)</div><img src='medTree-4.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'>## LOOKING FOR MEDIANS IN SEVERAL CLUSTERS</span>
<span class='co'>## identify 6 clusters</span>
<span class='no'>groves</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='findGroves.html'>findGroves</a></span>(<span class='no'>woodmiceTrees</span>, <span class='kw'>nf</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>nclust</span><span class='kw'>=</span><span class='fl'>6</span>)

<span class='co'>## find median trees</span>
<span class='no'>res.with.grp</span> <span class='kw'>&lt;-</span> <span class='fu'>medTree</span>(<span class='no'>woodmiceTrees</span>, <span class='no'>groves</span>$<span class='no'>groups</span>)

<span class='co'>## there is one output per cluster</span>
<span class='fu'>names</span>(<span class='no'>res.with.grp</span>)</div><div class='output co'>#&gt; [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot;</div><div class='input'>
<span class='co'>## get the first median of each</span>
<span class='no'>med.trees</span> <span class='kw'>&lt;-</span> <span class='fu'>lapply</span>(<span class='no'>res.with.grp</span>, <span class='kw'>function</span>(<span class='no'>e</span>) <span class='fu'>ladderize</span>(<span class='no'>e</span>$<span class='no'>trees</span><span class='kw'>[[</span><span class='fl'>1</span>]]))

<span class='co'>## plot trees</span>
<span class='fu'>par</span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>3</span>))
<span class='kw'>for</span>(<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fu'>length</span>(<span class='no'>med.trees</span>)) <span class='fu'>plot</span>(<span class='no'>med.trees</span><span class='kw'>[[</span><span class='no'>i</span>]], <span class='kw'>main</span><span class='kw'>=</span><span class='fu'>paste</span>(<span class='st'>"cluster"</span>,<span class='no'>i</span>))</div><img src='medTree-8.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'>## highlight the differences between a pair of median trees</span>
<span class='fu'><a href='plotTreeDiff.html'>plotTreeDiff</a></span>(<span class='no'>med.trees</span><span class='kw'>[[</span><span class='fl'>1</span>]],<span class='no'>med.trees</span><span class='kw'>[[</span><span class='fl'>5</span>]])</div><img src='medTree-10.png' alt='' width='540' height='400' /><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Jacob Almagro-Garcia <a href='mailto:nativecoder@gmail.com'>nativecoder@gmail.com</a>

Michelle Kendall <a href='mailto:michelle.louise.kendall@gmail.com'>michelle.louise.kendall@gmail.com</a>

Thibaut Jombart <a href='mailto:thibautjombart@gmail.com'>thibautjombart@gmail.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thibaut Jombart, Michelle Kendall, Jacob Almagro-Garcia, Caroline Colijn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
